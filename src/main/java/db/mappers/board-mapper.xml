<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	
	<entry key="selectListCount">
	
		<!-- 
			작성자: 조성범
			현재 자유게시판의 게시글 총 개수 
		-->
		SELECT COUNT(*) COUNT
		  FROM BOARD
		 WHERE BOARD_TYPE = 1
		   AND STATUS = 'Y'
	</entry>
	
	<entry key="selectList">
		<!-- 
			작성자: 조성범
			사용자가 요청한 페이지에 보여질 게시글 목록 조회 
		-->
		SELECT *
		  FROM (
		        SELECT ROWNUM RNUM, A.*
		          FROM (
		                SELECT
		                       BOARD_NO
		                     , BOARD_TITLE
		                     , USER_ID      -- MEMBER랑 조인     
		                     , B.ENROLL_DATE
		                     , READ_COUNT
		                 FROM BOARD B
		                 JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		                WHERE BOARD_TYPE = 1
		                  AND B.STATUS = 'Y'
		                ORDER
		                   BY BOARD_NO DESC
		                )A
		        )
		 WHERE RNUM BETWEEN ? AND ?
	
	</entry>
	
	
	<!-- 
		작성자: 조성범
		유효한 게시글에 접근시 조회수 증가 
	 -->
	<entry key="increaseCount">
		UPDATE
				BOARD
			SET READ_COUNT = READ_COUNT + 1
		  WHERE BOARD_NO = ?
		    AND STATUS = 'Y' 
	</entry>
	
	<!-- 
		작성자: 조성범
		게시글 상세페이지 조회
	 -->
	<entry key="selectBoard">
		SELECT
				BOARD_NO
			  ,	BOARD_TITLE
			  , USER_ID
			  , B.ENROLL_DATE
			  , READ_COUNT
			  , BOARD_CONTENT
		  FROM BOARD B
		  JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		 WHERE BOARD_NO = ?
		   AND BOARD_TYPE = 1
		   AND B.STATUS = 'Y'
	</entry>
	
	<!-- 
		작성자: 조성범
		자유게시판 게시글 등록
	 -->
	<entry key="insertBoard">
	
		INSERT
		  INTO BOARD
		  (
		    BOARD_NO
		  , BOARD_TYPE
		  , BOARD_TITLE
		  , BOARD_CONTENT
		  , BOARD_WRITER
		  )
		  VALUES
		  (
		    SEQ_BNO.NEXTVAL
		  , 1
		  , ?
		  , ?
		  , ?
		  )
	
	</entry>
	<!--  
		작성자: 조성범
		자유게시판 게시글 수정
	 -->
	
	<entry key="updateBoard">
		UPDATE
			   BOARD
		   SET BOARD_TITLE = ?
		     , BOARD_CONTENT = ?
		 WHERE BOARD_NO = ?
	</entry>
	
	
	
	<!-- 
		작성자: 조성범
		현재 사진게시판의 게시글 총 개수 
	-->
	<entry key="selecThtListCount">
	
		SELECT COUNT(*) COUNT
		  FROM BOARD
		 WHERE BOARD_TYPE = 2
		   AND STATUS = 'Y'
	</entry>
	
	
	<!-- 
		작성자: 조성범
		사진게시판 게시글 작성(Board)
	 -->
	<entry key="insertThBoard">
		INSERT
		  INTO BOARD
		  (
		    BOARD_NO
		  , BOARD_TYPE
		  , BOARD_TITLE
		  , BOARD_CONTENT
		  , BOARD_WRITER
		  )
		  VALUES
		  (
		    SEQ_BNO.NEXTVAL
		  , 2
		  , ?
		  , ?
		  , ?
		  )	  
	
	</entry>
	
	
	
	
	<entry key="insertThAttachment">
		INSERT
		  INTO ATTACHMENT
		  (
		    FILE_NO
		  , REF_BNO
		  , REF_TYPE
		  , ORIGIN_NAME
		  , CHANGE_NAME
		  , FILE_PATH
		  , FILE_LEVEL
		  )
		  VALUES
		  (
		    SEQ_ANO.NEXTVAL
		  , SEQ_BNO.CURRVAL
		  , 'B'
		  , ?
		  , ?
		  , ?
		  , ?
		  )
		  
	</entry>
	
	<entry key="selectThumbnailList">
	
	  
		SELECT * FROM (
	    SELECT 
	           ROW_NUMBER() OVER (ORDER BY B.BOARD_NO DESC) AS RNUM
	         , B.BOARD_NO
	         , B.BOARD_TITLE
	         , M.USER_ID
	         , B.ENROLL_DATE
	         , B.READ_COUNT
	         , A.FILE_PATH || A.CHANGE_NAME AS TITLEIMG_URL
	      FROM BOARD B
	      JOIN MEMBER M ON (B.BOARD_WRITER = M.USER_NO)
	      JOIN ATTACHMENT A ON (A.REF_BNO = B.BOARD_NO)
	     WHERE B.BOARD_TYPE = 2
	       AND B.STATUS = 'Y'
	       AND A.FILE_LEVEL = 1
	)
	WHERE RNUM BETWEEN ? AND ?
	
	</entry>
	
	<!-- 
		작성자: 조성범
		게시글 상세페이지 조회
	 -->
	<entry key="thSelectBoard">
		SELECT
				BOARD_NO
			  ,	BOARD_TITLE
			  , USER_ID
			  , B.ENROLL_DATE
			  , READ_COUNT
			  , BOARD_CONTENT
		  FROM BOARD B
		  JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		 WHERE BOARD_NO = ?
		   AND BOARD_TYPE = 2
		   AND B.STATUS = 'Y'
	</entry>
	
	
	<entry key="thSelectAttachment">
		SELECT
		       FILE_NO
		     , REF_BNO
		     , ORIGIN_NAME
		     , CHANGE_NAME
		     , FILE_PATH
		  FROM ATTACHMENT
		 WHERE REF_BNO = ?
		   AND REF_TYPE = 'B'
		   AND STATUS = 'Y'
		 ORDER
		    BY FILE_LEVEL ASC
	</entry>
	
	<!-- 
		작성자: 조성범
		사진게시판 게시글 수정(첨부파일을 수정할 때)
	 -->
	<entry key="updateAttachment">
		UPDATE
			  ATTACHMENT
		  SET ORIGIN_NAME = ?
		  	, CHANGE_NAME = ?
		  	, FILE_PATH = ?
		WHERE FILE_NO = ?
		  AND REF_TYPE = 'B'
	
	</entry>
	
	<!-- 
		작성자: 조성범
		사진게시판 게시글 수정(첨부파일을 추가할 때)
	 -->
	<entry key="insertNewAttachment">
		INSERT
		  INTO ATTACHMENT
		  (
		  	FILE_NO
		  , REF_BNO
		  , ORIGIN_NAME
		  , CHANGE_NAME
		  , FILE_PATH
		  )
		  VALUES
		  (
		  	SEQ_ANO.NEXTVAL
		  , 
		  )
	</entry>
	
	<entry key="selectReplyList">
		SELECT
			    REPLY_NO
			  , USER_ID
			  , REPLY_CONTENT
			  , TO_CHAR(REPLY.ENROLL_DATE, 'YYYY/MM/DD HH:MI')AS ENROLL_DATE
		 FROM REPLY
		 JOIN MEMBER ON (REPLY_WRITER = USER_NO)
		WHERE REPLY_BNO = ?
		  AND REPLY.STATUS = 'Y'
		ORDER
		   BY REPLY_NO DESC
		  
	</entry>
	
	<entry key="insertReply">
		INSERT 
		  INTO REPLY
		  (
		    REPLY_NO
		  , REPLY_WRITER
		  , REPLY_BNO
		  , REPLY_CONTENT
		  )		  
		  VALUES
		  (
		    SEQ_RNO.NEXTVAL
		  , ?
		  , ?
		  , ?
		  )
	</entry>
	
	<!-- 
		작성자: 조성범
		게시글 삭제
	 -->
	<entry key="deleteBoard">
   		UPDATE
   			  BOARD
   		  SET STATUS = 'N'
   		WHERE BOARD_NO = ?
   	
   	</entry>
   	
   	<entry key="searchBoardListCount">
	
		<!-- 
			작성자: 조성범
			일반게시글 검색 된 개수 
		-->
		SELECT COUNT(*) COUNT
		  FROM BOARD
		  JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		 WHERE BOARD_TYPE = 1
		   AND BOARD.STATUS = 'Y'
		   
	</entry>
	
	
	
	<entry key="searchBoardList">
		SELECT
               BOARD_NO
             , BOARD_TITLE
             , USER_ID          
             , B.ENROLL_DATE
             , READ_COUNT
         FROM BOARD B
         JOIN MEMBER ON (BOARD_WRITER = USER_NO)
        WHERE BOARD_TYPE = 1
          AND B.STATUS = 'Y'
        
           
	</entry>
	
		<!-- 
			작성자: 조성범
			사진게시글 검색 된 개수 
		-->
	
	<entry key="searchThumbnailListCount">
	
		SELECT COUNT(*) COUNT
		  FROM BOARD
		  JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		 WHERE BOARD_TYPE = 2
		   AND STATUS = 'Y'
	</entry>
	
	
	<entry key="searchThumbnailList">
		SELECT
               BOARD_NO
             , BOARD_TITLE
             , USER_ID          
             , B.ENROLL_DATE
             , READ_COUNT
         FROM BOARD B
         JOIN MEMBER ON (BOARD_WRITER = USER_NO)
        WHERE BOARD_TYPE = 2
          AND B.STATUS = 'Y'
        
           
	</entry>
	
   	

	

	<!-- ============================================================== -->

	
	
	
	<!--   관리자 페이지에 보여질 게시글 목록 조회
	<entry key="selectManagerBoardList">
		
		SELECT *
		  FROM (
		        SELECT ROWNUM RNUM, A.*
		          FROM (
		                SELECT
		                       BOARD_NO
		                     , BOARD_TYPE
		                     , BOARD_TITLE
		                     , BOARD_CONTENT
		                     , USER_ID       MEMBER랑 조인     
		                     , B.ENROLL_DATE
		                     , READ_COUNT
		                 FROM BOARD B
		                 JOIN MEMBER ON (BOARD_WRITER = USER_NO)
		                WHERE B.STATUS = 'Y'
		                ORDER
		                   BY BOARD_NO DESC
		                )A
		        )
		 WHERE RNUM BETWEEN ? AND ?
	
	</entry>
	-->
	
	<entry key="searchBoardKeyword">
		<!--  김영주  관리자 게시글 검색 결과 조회-->
		SELECT
               BOARD_NO
             , BOARD_TYPE
             , BOARD_TITLE
             , BOARD_CONTENT
             , USER_ID          
             , B.ENROLL_DATE
             , READ_COUNT
         FROM BOARD B
         JOIN MEMBER ON (BOARD_WRITER = USER_NO)
        WHERE B.STATUS = 'Y'
	</entry>
	
	<entry key="deleteManagerBoard">
		<!-- 김영주 관리자 - 게시글 선택 삭제 -->
		UPDATE
		       BOARD
		   SET STATUS = 'N'  
	
	</entry>
	
	
	<entry key="searchBoardListCount">
	<!-- 김영주 관리자-게시글 검색 결과 총 개수 조회 -->
		SELECT COUNT(*) COUNT
	  	  FROM BOARD B
	  	  JOIN MEMBER ON (BOARD_WRITER = USER_NO)
	     WHERE B.STATUS = 'Y'
	</entry>
	
	
	
	<!-- 관리자- 댓글 검색 결과 조회 
	<entry key="searchReplyKeyword">
	SELECT *
	  FROM (
	    SELECT ROWNUM RNUM, A.*
	    FROM (
	            SELECT
	                   REPLY_NO
	                 , BOARD_TYPE  
	                 , USER_ID
	                 , REPLY_BNO
	                 , REPLY_CONTENT
	                 , TO_CHAR(R.ENROLL_DATE, 'YYYY-MM-DD HH24:MI') ENROLL_DATE
	                 , R.STATUS
	              FROM REPLY R
	              JOIN BOARD ON (REPLY_BNO = BOARD_NO)
	              JOIN MEMBER ON (REPLY_WRITER = USER_NO)
	             WHERE R.STATUS = 'Y'
	               AND BOARD_TYPE IN  ( 1, 2)
	               AND REPLY_CONTENT LIKE '%ㅋㅋㅋ%'
	               AND USER_ID LIKE '%user1%'
	             ORDER
	                BY REPLY_NO DESC
	        ) A 
	    
	 	   )
	  WHERE RNUM BETWEEN ? AND ?	   
	</entry>
	-->
	
	<entry key="searchReplyKeyword">
		<!--김영주 관리자- 댓글 검색 결과 조회 -->
		            SELECT
		                   REPLY_NO
		                 , BOARD_TYPE  
		                 , USER_ID
		                 , REPLY_BNO
		                 , REPLY_CONTENT
		                 , TO_CHAR(R.ENROLL_DATE, 'YYYY-MM-DD HH24:MI') ENROLL_DATE
		                 , R.STATUS
		              FROM REPLY R
		              JOIN BOARD ON (REPLY_BNO = BOARD_NO)
		              JOIN MEMBER ON (REPLY_WRITER = USER_NO)
		             WHERE R.STATUS = 'Y'
		    
	</entry>
	
	<entry key="searchReplyListCount">
	<!--김영주 관리자- 댓글 검색 결과 개수 -->
		SELECT
               COUNT(*) COUNT
          FROM REPLY R
          JOIN BOARD ON (REPLY_BNO = BOARD_NO)
          JOIN MEMBER ON (REPLY_WRITER = USER_NO)
         WHERE R.STATUS = 'Y'
	</entry>
	
	<entry key="deleteManagerReply">
	<!--김영주 관리자 - 댓글 선택 삭제 -->
		UPDATE
		       REPLY
		   SET STATUS = 'N'    
	</entry>
	
	<entry key="selectAttachment">
	<!-- 김영주 관리자- 포토게시판 첨부파일 조회 -->
		SELECT
		       FILE_NO
		     , REF_BNO
		     , ORIGIN_NAME
		     , CHANGE_NAME
		     , FILE_PATH
		     , FILE_LEVEL
		  FROM ATTACHMENT
		 WHERE REF_TYPE = 'B'
		   AND STATUS = 'Y'
		 ORDER
		    BY FILE_LEVEL ASC
	</entry>
	
	<!-- 관리자 -리뷰 검색 결과 조회 
	<entry key="searchReviewKeyword">
		 SELECT * 
		   FROM
				(
					SELECT 
				           DENSE_RANK() OVER(ORDER BY RE_NO DESC) AS RANK 
				         , RE_NO
				         , R.PRO_NO
				         , PRO_NAME
				         , USER_ID
				         , RE_TITLE
				         , RE_CONTENT
				         , RE_STAR
				         , R.ENROLL_DATE
				         , READ_COUNT
				         , R.STATUS
				         , MACRO_NO
				         , REVIEW
				         , FILE_NO
				         , REF_BNO
				         , REF_TYPE
				         , ORIGIN_NAME
				         , CHANGE_NAME
				         , FILE_PATH
				         , FILE_LEVEL
			        
			          FROM REVIEW R
			          JOIN MEMBER ON (RE_WRITER = USER_NO)
			          JOIN PRODUCT P ON (R.PRO_NO = P.PRO_NO)
			          LEFT JOIN ATTACHMENT ON (REF_TYPE = 'R' AND RE_NO = REF_BNO)
			         WHERE R.STATUS IN ('Y','N')   
			      ) 
	      WHERE RANK BETWEEN 1 AND 10;
		
	</entry>
	-->
	
	<entry key="searchReviewKeyword">
	<!-- 김영주 관리자 -리뷰 검색 결과 조회 -->
		SELECT 
	           DENSE_RANK() OVER(ORDER BY RE_NO DESC) AS RANK 
	         , RE_NO
	         , R.PRO_NO
	         , PRO_NAME
	         , USER_ID
	         , RE_TITLE
	         , RE_CONTENT
	         , RE_STAR
	         , TO_CHAR(R.ENROLL_DATE, 'YYYY-MM-DD') ENROLL_DATE
	         , READ_COUNT
	         , R.STATUS
	         , MACRO_NO
	         , REVIEW
	         , FILE_NO
	         , REF_BNO
	         , REF_TYPE
	         , ORIGIN_NAME
	         , CHANGE_NAME
	         , FILE_PATH
	         , FILE_LEVEL
        
          FROM REVIEW R
          JOIN MEMBER ON (RE_WRITER = USER_NO)
          JOIN PRODUCT P ON (R.PRO_NO = P.PRO_NO)
          LEFT JOIN ATTACHMENT ON (REF_TYPE = 'R' AND RE_NO = REF_BNO)
         WHERE R.STATUS IN ('Y','N')
	</entry>
	
	<entry key="searchReviewListCount">
	<!-- 김영주 관리자 -리뷰 검색 결과 개수 조회 -->
		SELECT COUNT(*) COUNT
  		  FROM REVIEW R
          JOIN MEMBER ON (USER_NO = RE_WRITER)
          JOIN PRODUCT P ON (R.PRO_NO = P.PRO_NO)
         WHERE R.STATUS IN ('Y', 'N')
	</entry>
	
	<entry key="insertMacro">
	<!-- 김영주 관리자- 매크로 등록 -->
		INSERT 
		  INTO MACRO
		  (
		    MACRO_NO
          , MACRO_CONTENT
		  )
		  VALUES
		  (
		  	SEQ_MAC.NEXTVAL
		  , ?	
		  )
	</entry>
	
	<entry key="selectMacro">
	<!-- 김영주 관리자 매크로 목록 조회 -->
		SELECT 
		       MACRO_NO
             , MACRO_CONTENT
          FROM MACRO   
	</entry>
	
	<entry key="deleteMacro">
	<!-- 김영주 관리자 매크로 삭제 -->
		DELETE
		       MACRO
		 WHERE MACRO_NO = ?      
	
	</entry>
	
	<entry key="insertManagerReview">
	<!-- 김영주 관리자 리뷰답변 등록 -->
		UPDATE
		       REVIEW
		   SET  
		       REVIEW = ?
		     , STATUS = 'Y'
		 WHERE RE_NO = ?    
	</entry>
	
	<entry key="deleteManagerReview">
	<!-- 김영주 관리자 리뷰 선택 삭제 -->
		UPDATE
		       REVIEW
		   SET STATUS = 'D'    
	
	</entry>
	
	<entry key="selectReviewList">
		SELECT * FROM
		(
		SELECT 
		        DENSE_RANK() OVER(ORDER BY RE_NO DESC) AS RANK 
		        , RE_NO
		        ,R.PRO_NO
		        , PRO_NAME
		        ,USER_ID
		        ,RE_TITLE
		        ,RE_CONTENT
		        ,RE_STAR
		        ,TO_CHAR(R.ENROLL_DATE, 'YYYY-MM-DD') ENROLL_DATE
		        ,READ_COUNT
		        ,R.STATUS
		        ,MACRO_NO
		        ,REVIEW
		        ,FILE_NO
		        ,REF_BNO
		        ,REF_TYPE
		        ,ORIGIN_NAME
		        ,CHANGE_NAME
		        ,FILE_PATH
		        ,FILE_LEVEL
		        
		        FROM REVIEW R
		        JOIN MEMBER ON (RE_WRITER = USER_NO)
		        JOIN PRODUCT P ON (R.PRO_NO = P.PRO_NO)
		        LEFT JOIN ATTACHMENT ON (REF_TYPE = 'R' AND RE_NO = REF_BNO) 
		        WHERE R.STATUS IN ('Y','N') 
		        ) 
		        WHERE RANK BETWEEN ? AND ?  
	</entry>
	
	<!-- 사용자 리뷰게시판 첨부파일 조회 <이주리 -->
	<entry key="selectAttachmentReview">
		SELECT
		       FILE_NO
		     , REF_BNO
		     , ORIGIN_NAME
		     , CHANGE_NAME
		     , FILE_PATH
		     , FILE_LEVEL
		  FROM ATTACHMENT
		 WHERE REF_TYPE = 'R'
		   AND STATUS = 'Y'
		   AND REF_BNO = ?
		 ORDER
		    BY FILE_LEVEL ASC
	</entry>

</properties>
